# 参数初始化环节修正实施计划

## 需要修正的问题

1. **没有打开过的调整组不应该生效**
2. **所有的调整组参数应该初始化为无效果的值**  
3. **去雾强度应该初始化为零,此时应该跳过此步骤**

## 实施方案

### 1. 调整组访问状态追踪

在`useControlsLogic.ts`中添加`visitedGroups`状态，追踪哪些调整组被用户打开过。

### 2. 修改参数初始化

#### 2.1 去雾参数 (DehazeParams)
- 添加一个`strength`或`enabled`字段，初始化为0或false
- 在imageProcessor中检查该字段，如果为0/false则跳过去雾处理

#### 2.2 清晰度参数 (ClarityParams)  
- `enhancementStrength`已初始化为1.0（无效果）
- `macroEnhancement`已初始化为0.0（无效果）
- 需要确认这是正确的无效果值

#### 2.3 曝光参数
- `exposureStrength`初始化为1.0（无效果）
- `exposureManual`所有参数初始化为1.0（无效果）
- 已经正确

#### 2.4 亮度参数 (LuminanceParams)
- 所有调整值已初始化为0（无效果）
- 已经正确

#### 2.5 HSL参数
- globalHSL所有值已初始化为0（无效果）
- hslLayers初始化为空数组
- 已经正确

### 3. 在processImageToTileable中添加条件检查

对于每个调整步骤，检查：
- 该调整组是否被访问过
- 参数是否为有效值（不是初始的无效果值）

只有两个条件都满足时才应用调整。

## 文件修改清单

1. `useControlsLogic.ts` - 添加visitedGroups状态
2. `useTextureGenerator.ts` - 传递visitedGroups状态  
3. `imageProcessor.ts` - 添加条件检查逻辑
4. `dehazeAdjustment.ts` - 添加strength/enabled字段到DehazeParams
5. `DehazePanel.vue` - 更新UI以支持新的enabled字段

## 实施步骤

[ ] 1. 修改DehazeParams接口，添加enabled字段
[ ] 2. 更新useTextureGenerator中的去雾参数初始化
[ ] 3. 在useControlsLogic中添加visitedGroups追踪
[ ] 4. 修改imageProcessor，添加条件检查
[ ] 5. 更新DehazePanel以支持enabled切换
[ ] 6. 测试验证所有调整组的条件应用
