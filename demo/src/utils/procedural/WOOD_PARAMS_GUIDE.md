# 木材纹理生成器参数说明

## 概述

木材纹理生成器现在暴露了**24个可调参数**（原本只有9个基础参数），让你能够精细控制木材的外观。

## 参数分类

### 基础参数 (9个)

这些是之前就有的参数：

1. **tileSize** (平铺尺寸)
   - 范围：0.5 - 2.0
   - 默认值：1.0
   - 作用：控制无缝循环的周期，值越大纹理越密集

2. **ringScale** (年轮总数)
   - 范围：3.0 - 20.0
   - 默认值：8.0
   - 作用：控制年轮的数量，值越大年轮越密

3. **ringDistortion** (生长扭曲度)
   - 范围：0.0 - 3.0
   - 默认值：1.0
   - 作用：模拟木材自然生长时的扭曲变形

4. **knotIntensity** (树结强度)
   - 范围：0.0 - 3.0
   - 默认值：1.0
   - 作用：控制树结（疙瘩）的明显程度

5. **latewoodBias** (晚材偏差)
   - 范围：0.2 - 5.0
   - 默认值：0.8
   - 作用：控制深色条纹的锐利度，值越大越尖锐（硬木特征）

6. **rayStrength** (髓射线强度)
   - 范围：0.0 - 1.0
   - 默认值：0.5
   - 作用：控制垂直于年轮的细纹（橡木、榉木等高档木材特征）

7. **poreDensity** (导管密度)
   - 范围：0.0 - 30.0
   - 默认值：10.0
   - 作用：控制木材表面小孔的密度（硬木特征）

8. **colorEarly** (早材颜色)
   - 格式：[r, g, b]（0.0-1.0）
   - 默认值：[0.86, 0.72, 0.54] (#DCC8A9)
   - 作用：控制浅色部分的颜色

9. **colorLate** (晚材颜色)
   - 格式：[r, g, b]（0.0-1.0）
   - 默认值：[0.45, 0.31, 0.20] (#734F33)
   - 作用：控制深色部分的颜色

---

### 新增高级参数 (12个)

这些是新暴露的参数，可以更精细地控制纹理细节：

#### FBM 噪声控制

10. **fbmOctaves** (FBM 噪声层数)
    - 范围：1 - 5
    - 默认值：3
    - 作用：控制噪声的复杂度，值越大细节越丰富但性能越低

11. **fbmAmplitude** (FBM 初始振幅)
    - 范围：0.1 - 1.0
    - 默认值：0.5
    - 作用：控制噪声的整体强度

#### 噪声频率控制

12. **knotFrequency** (树结噪声频率)
    - 范围：0.5 - 2.0
    - 默认值：0.8
    - 作用：控制树结分布的稀疏程度，值越大树结越密集

13. **distortionFreq** (域扭曲频率)
    - 范围：1.0 - 3.0
    - 默认值：1.5
    - 作用：控制纹理扭曲的细节程度

14. **ringNoiseFreq** (年轮噪声频率)
    - 范围：3.0 - 10.0
    - 默认值：5.0
    - 作用：控制年轮粗细变化的频率

15. **rayFrequencyX** (髓射线X频率)
    - 范围：30.0 - 100.0
    - 默认值：50.0
    - 作用：控制髓射线横向的密集程度

16. **rayFrequencyY** (髓射线Y频率)
    - 范围：1.0 - 5.0
    - 默认值：2.0
    - 作用：控制髓射线纵向的延伸

#### 树结阈值控制

17. **knotThresholdMin** (树结阈值最小值)
    - 范围：0.0 - 1.0
    - 默认值：0.4
    - 作用：控制树结出现的最小阈值

18. **knotThresholdMax** (树结阈值最大值)
    - 范围：0.0 - 1.0
    - 默认值：0.8
    - 作用：控制树结出现的最大阈值
    - 提示：Min和Max的差值越大，树结过渡越平滑

#### 物理属性控制

19. **normalStrength** (法线强度)
    - 范围：1.0 - 20.0
    - 默认值：8.0
    - 作用：控制表面凹凸的视觉效果

20. **roughnessMin** (最小粗糙度)
    - 范围：0.1 - 0.5
    - 默认值：0.35
    - 作用：控制光滑区域（早材）的粗糙度

21. **roughnessMax** (最大粗糙度)
    - 范围：0.5 - 1.0
    - 默认值：0.7
    - 作用：控制粗糙区域（晚材、孔隙）的粗糙度

---

## 木材类型预设建议

### 红松 (Pine)
```typescript
{
    ringScale: 5.0,           // 纹理宽
    latewoodBias: 0.5,       // 过渡平滑
    knotIntensity: 1.2,      // 树结明显
    poreDensity: 0.0,        // 针叶林无明显导管
    knotFrequency: 0.6,      // 树结较稀疏
    rayStrength: 0.2,        // 髓射线不明显
}
```

### 白橡 (White Oak)
```typescript
{
    ringScale: 12.0,         // 纹理密
    latewoodBias: 3.0,       // 晚材线条锐利
    rayStrength: 0.8,        // 明显的髓射线
    poreDensity: 20.0,       // 明显的导管孔隙
    rayFrequencyX: 70.0,     // 髓射线很密集
    normalStrength: 12.0,    // 表面凹凸明显
}
```

### 黑胡桃 (Walnut)
```typescript
{
    colorEarly: [0.45, 0.35, 0.25],
    colorLate: [0.2, 0.15, 0.1],
    ringDistortion: 1.5,     // 高度扭曲
    latewoodBias: 1.5,       // 适中
    knotIntensity: 0.8,      // 树结较少
    distortionFreq: 2.0,     // 扭曲细节丰富
}
```

### 枫木 (Maple)
```typescript
{
    ringScale: 10.0,
    latewoodBias: 2.0,
    rayStrength: 0.3,
    poreDensity: 5.0,
    colorEarly: [0.95, 0.92, 0.85],
    colorLate: [0.75, 0.68, 0.58],
    ringNoiseFreq: 7.0,      // 年轮变化细腻
}
```

---

## 使用建议

1. **从基础参数开始**：先调整 `ringScale`、`colorEarly`、`colorLate` 等基础参数确定大致外观

2. **逐步细化**：再调整高级参数如 `fbmOctaves`、各种频率参数来增加细节

3. **性能考虑**：
   - `fbmOctaves` 越高性能消耗越大，建议保持在3-4
   - 过高的频率参数可能导致摩尔纹，需要配合足够的纹理分辨率

4. **真实感调整**：
   - 自然木材通常有不规则性，适当增加 `ringDistortion` 和 噪声频率
   - 不同木材的 `latewoodBias` 差异很大，这是区分软木和硬木的关键参数

5. **导出前测试**：在不同光照条件下预览，调整 `normalStrength` 和粗糙度参数

---

## 技术说明

所有参数都通过 WebGPU uniform buffer 传递给 shader，修改参数后需要重新生成纹理。

新增的12个参数在 uniform buffer 中的位置是索引32-43（原参数占用0-31）。
