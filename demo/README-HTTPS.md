# HTTPS 开发服务器配置指南

本配置解决了手机端访问开发服务器时出现的"连接不安全"问题。

## 快速开始

### 1. 安装依赖
```bash
npm install
```

### 2. 生成SSL证书
```bash
npm run ssl:generate
```

### 3. 启动HTTPS开发服务器
```bash
npm run dev:https
```

### 4. 在手机端访问
1. 确保手机和开发机器在同一网络下
2. 在手机浏览器中访问 `https://你的电脑IP:3000`
3. 接受自签名证书风险警告（详见下方说明）

## 手机端访问详细步骤

### iOS设备 (iPhone/iPad)
1. 在Safari中输入 `https://你的电脑IP:3000`
2. 看到"此网站的安全证书有问题"警告时，点击"详细信息"
3. 点击"访问此网站（不安全）"
4. 如果出现更多安全警告，继续点击"访问"

### Android设备
1. 在Chrome中输入 `https://你的电脑IP:3000`
2. 看到"您的连接不是私密连接"警告时，点击"高级"
3. 点击"继续前往 你的电脑IP（不安全）"
4. 如果浏览器阻止访问，可以尝试：
   - 在警告页面点击"证书详情"
   - 选择"继续前往"

## 获取电脑IP地址

### Windows
```cmd
ipconfig
```
查找"无线局域网适配器"或"以太网适配器"下的IPv4地址

### macOS/Linux
```bash
ifconfig | grep "inet "
```
或
```bash
ip addr show
```

## 配置说明

### Vite配置
- 支持条件HTTPS：通过 `--mode https` 启用
- 自动检测SSL证书：只有证书存在时才启用HTTPS
- 移动设备优化：添加了必要的安全头部

### SSL证书
- 使用自签名证书，适用于开发环境
- 包含本地主机和IP地址的SAN扩展
- 有效期365天

### 网络配置
- 服务器绑定到 `0.0.0.0`，允许外部访问
- 默认端口3000
- 支持所有现代浏览器

## 故障排除

### 证书问题
如果证书生成失败：
1. 确保系统已安装OpenSSL
2. 或运行 `npm install selfsigned` 使用Node.js生成

### 网络访问问题
1. 检查防火墙设置，确保端口3000开放
2. 确认手机和电脑在同一WiFi网络
3. 尝试关闭VPN或代理

### 浏览器阻止访问
1. 清除浏览器缓存和Cookie
2. 尝试无痕模式
3. 在桌面浏览器先访问一次，确认证书有效

## 生产环境注意

此配置仅适用于开发环境！
生产环境请使用：
- 正式的SSL证书（Let's Encrypt等）
- 适当的安全配置
- CDN和反向代理

## 技术细节

### 证书生成脚本
- 优先使用系统OpenSSL
- 备用方案：Node.js selfsigned库
- 自动创建证书目录

### Vite配置特性
- 条件HTTPS支持
- 安全头部配置
- CORS支持
- 热重载保持

### 移动设备优化
- HSTS头部
- CSP升级策略
- 跨域支持